{"version":3,"sources":["../src/client.ts"],"names":[],"mappings":"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","file":"chunk-ZTLXC3XU.js","sourcesContent":["import { Client } from \"@modelcontextprotocol/sdk/client/index.js\";\r\nimport { StdioClientTransport } from \"@modelcontextprotocol/sdk/client/stdio.js\";\r\nimport type { MCPTool } from \"@repo/shared\";\r\n\r\nexport interface TransportConfig {\r\n    type: \"stdio\" | \"sse\" | \"websocket\";\r\n    command?: string;\r\n    args?: string[];\r\n    url?: string;\r\n}\r\n\r\nexport class MCPClient {\r\n    private client: Client;\r\n    private connected = false;\r\n    private cachedTools: MCPTool[] | null = null;\r\n\r\n    constructor(\r\n        private name: string,\r\n        private config: TransportConfig\r\n    ) {\r\n        this.client = new Client(\r\n            { name: `${name}-client`, version: \"1.0.0\" },\r\n            { capabilities: {} }\r\n        );\r\n    }\r\n\r\n    async connect(): Promise<void> {\r\n        if (this.connected) {\r\n            return;\r\n        }\r\n\r\n        const transport = this.createTransport();\r\n        await this.client.connect(transport);\r\n        this.connected = true;\r\n    }\r\n\r\n    async disconnect(): Promise<void> {\r\n        if (!this.connected) {\r\n            return;\r\n        }\r\n\r\n        await this.client.close();\r\n        this.connected = false;\r\n        this.cachedTools = null;\r\n    }\r\n\r\n    private createTransport(): StdioClientTransport {\r\n        if (this.config.type !== \"stdio\") {\r\n            throw new Error(`Transport type \"${this.config.type}\" not yet supported`);\r\n        }\r\n\r\n        if (!this.config.command) {\r\n            throw new Error(\"stdio transport requires a command\");\r\n        }\r\n\r\n        return new StdioClientTransport({\r\n            command: this.config.command,\r\n            args: this.config.args,\r\n        });\r\n    }\r\n\r\n    async listTools(): Promise<MCPTool[]> {\r\n        if (!this.connected) {\r\n            throw new Error(\"Client not connected\");\r\n        }\r\n\r\n        if (this.cachedTools) {\r\n            return this.cachedTools;\r\n        }\r\n\r\n        const result = await this.client.listTools();\r\n        this.cachedTools = result.tools.map((t) => ({\r\n            name: t.name,\r\n            description: t.description ?? \"\",\r\n            inputSchema: t.inputSchema as Record<string, unknown>,\r\n        }));\r\n\r\n        return this.cachedTools;\r\n    }\r\n\r\n    async callTool(name: string, args: Record<string, unknown>): Promise<unknown> {\r\n        if (!this.connected) {\r\n            throw new Error(\"Client not connected\");\r\n        }\r\n\r\n        const result = await this.client.callTool({ name, arguments: args });\r\n        return result;\r\n    }\r\n\r\n    get isConnected(): boolean {\r\n        return this.connected;\r\n    }\r\n\r\n    get serverName(): string {\r\n        return this.name;\r\n    }\r\n\r\n    invalidateToolCache(): void {\r\n        this.cachedTools = null;\r\n    }\r\n}\r\n"]}