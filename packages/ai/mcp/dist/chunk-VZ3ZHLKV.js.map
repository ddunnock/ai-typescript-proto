{"version":3,"sources":["../src/server.ts"],"names":[],"mappings":"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","file":"chunk-VZ3ZHLKV.js","sourcesContent":["import { Server } from \"@modelcontextprotocol/sdk/server/index.js\";\r\nimport { StdioServerTransport } from \"@modelcontextprotocol/sdk/server/stdio.js\";\r\nimport {\r\n    ListToolsRequestSchema,\r\n    CallToolRequestSchema,\r\n} from \"@modelcontextprotocol/sdk/types.js\";\r\nimport type { MCPTool } from \"@repo/shared\";\r\n\r\nexport type ToolHandler = (args: Record<string, unknown>) => Promise<{\r\n    content: Array<{ type: string; text: string }>;\r\n}>;\r\n\r\ninterface RegisteredTool {\r\n    schema: MCPTool;\r\n    handler: ToolHandler;\r\n}\r\n\r\nexport class MCPServerWrapper {\r\n    private server: Server;\r\n    private tools: Map<string, RegisteredTool> = new Map();\r\n    private started = false;\r\n\r\n    constructor(\r\n        public readonly name: string,\r\n        public readonly version: string\r\n    ) {\r\n        this.server = new Server(\r\n            { name, version },\r\n            { capabilities: { tools: {} } }\r\n        );\r\n        this.setupHandlers();\r\n    }\r\n\r\n    registerTool(\r\n        name: string,\r\n        description: string,\r\n        inputSchema: Record<string, unknown>,\r\n        handler: ToolHandler\r\n    ): void {\r\n        if (this.started) {\r\n            throw new Error(\"Cannot register tools after server has started\");\r\n        }\r\n\r\n        this.tools.set(name, {\r\n            schema: { name, description, inputSchema },\r\n            handler,\r\n        });\r\n    }\r\n\r\n    private setupHandlers(): void {\r\n        this.server.setRequestHandler(ListToolsRequestSchema, async () => ({\r\n            tools: Array.from(this.tools.values()).map((t) => ({\r\n                name: t.schema.name,\r\n                description: t.schema.description,\r\n                inputSchema: t.schema.inputSchema,\r\n            })),\r\n        }));\r\n\r\n        this.server.setRequestHandler(CallToolRequestSchema, async (request) => {\r\n            const toolName = request.params.name;\r\n            const tool = this.tools.get(toolName);\r\n\r\n            if (!tool) {\r\n                throw new Error(`Unknown tool: ${toolName}`);\r\n            }\r\n\r\n            const args = (request.params.arguments ?? {}) as Record<string, unknown>;\r\n            return tool.handler(args);\r\n        });\r\n    }\r\n\r\n    async start(): Promise<void> {\r\n        if (this.started) {\r\n            throw new Error(\"Server already started\");\r\n        }\r\n\r\n        const transport = new StdioServerTransport();\r\n        await this.server.connect(transport);\r\n        this.started = true;\r\n    }\r\n\r\n    async callTool(name: string, args: Record<string, unknown>): Promise<unknown> {\r\n        const tool = this.tools.get(name);\r\n        if (!tool) {\r\n            throw new Error(`Tool not found: ${name}`);\r\n        }\r\n        return tool.handler(args);\r\n    }\r\n\r\n    getTools(): MCPTool[] {\r\n        return Array.from(this.tools.values()).map((t) => t.schema);\r\n    }\r\n\r\n    getToolNames(): string[] {\r\n        return Array.from(this.tools.keys());\r\n    }\r\n\r\n    hasTool(name: string): boolean {\r\n        return this.tools.has(name);\r\n    }\r\n\r\n    get isStarted(): boolean {\r\n        return this.started;\r\n    }\r\n}\r\n"]}